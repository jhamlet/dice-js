(function(){var doc=typeof document!="undefined"?document:!1,hdr=doc&&doc.getElementsByTagName("head")[0],$i=this.__infuse__=function(modId,callback){var src,node,module=$i.modules[modId];return module.exports||(src=module,module=$i.modules[modId]={exports:{},loading:!0,loaded:!1,loadCallback:callback},typeof src=="function"?src():typeof src=="string"&&(doc?(hdr=doc.getElementsByTagName("head")[0],node=doc.createElement("script"),node.innerHTML=src,module.loadCallback=function(e){hdr.removeChild(node),callback&&callback(e)},hdr.appendChild(node)):eval(src))),module.exports};$i.clear=function(e){var t=$i.modules[e],n=t.loadCallback;t.loading=!1,t.loaded=!0,delete t.loadCallback,n&&n(t.exports)},$i.modules={0:"(function(){function n(e,t,n){return Array.prototype.slice.call(e,t,n)}function r(){var e=n(arguments);return e.reduce(function(e,t){return Object.keys(t).reduce(function(e,n){return e[n]=t[n],e},e)},e.shift())}function i(e,t){return e-t}function s(e){return Math.floor(Math.random()*e)+1}function o(e,t){return e+t}var e=__infuse__.modules[0],t=e.exports;e.exports={slice:n,merge:r,numericSort:i,rollDie:s,reduceSum:o},r(e.exports,__infuse__(1)),__infuse__.clear(0)})()",1:"(function(){var e=__infuse__.modules[1],t=e.exports;(function(){function r(e,r){return t.merge({},n,{value:e},r||{})}function i(e,n){return t.merge(r(e,n),{enumerable:!1})}var t=__infuse__(0),n={enumerable:!0,writable:!0,configurable:!0};e.exports={derive:Object.create,property:r,method:r,privateProperty:i,privateMethod:i}})(),__infuse__.clear(1)})()"}})(),function(e){function s(e,t,r){arguments.length===1&&(t=e,e=1),this.count=e,this.sides=t,Object.defineProperty(this,"_behaviors",n.privateProperty([])),r&&this.addBehavior.apply(this,r)}function o(){var e=this.init;e&&typeof e=="function"&&e.apply(this,arguments)}function u(e,r){var i=function(){o.apply(this,arguments)};return n.merge(i.prototype=n.derive(o.prototype),r),i.prototype.type=e,t[e]=i}function a(e){var r,i,s=t[e];if(!s)throw new Error("Unknown behavior '"+e+"'");return r=s.prototype,typeof r.init=="function"?(i=n.derive(r),s.apply(i,n.slice(arguments,1)),i):r}function f(e,t){return function(n){var r=new s(n,e);return t&&t.forEach(function(e){r.addBehavior(i(e)?a.apply(null,e):a(e))}),r}}var t,n=__infuse__(0),r=function(){},i=Array.isArray;s.prototype=n.derive(Object.prototype,{count:n.property(1),sides:n.property(0),rolled:n.property(!1),total:n.property(0),roll:n.method(function(){return this.rolled?this.total:(this.total=this._roll(),this.rolled=!0,this._applyBehaviors("roll"),this.total)}),reroll:n.method(function(){return this.reset(),this.roll()}),reset:n.method(function(){return delete this.total,delete this.results,delete this.rolled,this._applyBehaviors("reset"),this}),addBehavior:n.method(function(){return n.slice(arguments).forEach(function(e){this.push(e)},this._behaviors),this}),toString:n.method(function(){var e,t={count:this.count,sides:this.sides,total:this.total,modifiers:[],results:this.results||[],suffix:"",addenda:""};return this._applyBehaviors("toString",[t]),e=t.modifiers.reduce(n.reduceSum,0),(t.label?t.label:(t.count>1?t.count:"")+"d"+t.sides)+(e!==0?e>0?"+"+e:e:"")+(this.rolled?" ["+t.results.join(", ")+"] = "+t.total+(t.suffix?t.suffix:"")+(t.addenda?" ("+t.addenda+")":""):"")}),_roll:n.privateMethod(function(){var e,t=0,r=this.count,i=this.sides,s=0,o=this.results=[];for(t;t<r;t++)e=n.rollDie(i),o.push(e),s+=e;return s}),_applyBehaviors:n.privateMethod(function(e,t){return t=t||[],t.unshift(this),this._behaviors.forEach(function(n){n[e].apply(n,t)},this),this})}),s.behaviors=t={},o.prototype=n.derive(Object.prototype,{roll:n.method(r),reset:n.method(r),toString:n.method(r)}),s.DiceBehavior=o,s.createBehavior=u,s.getBehavior=a,s.makeDiceFactory=f,u("ResultModifier",{init:function(e){this.amount=e},roll:function(e){e.total+=this.amount},toString:function(e,t){t.modifiers.push(this.amount)}}),u("DieModifier",{init:function(e){this.amount=e},roll:function(e){e.total+=this.amount*e.count},toString:function(e,t){t.modifiers.push(this.amount*e.count)}}),u("RemoveLowest",{init:function(e){this.amount=e},roll:function(e){var t=e.results.sort(n.numericSort).reverse();e.lowResults=t.splice(e.count-this.amount),e.total=t.reduce(n.reduceSum,0)},reset:function(e){delete e.lowResults},toString:function(e,t){t.addenda+="low: ["+e.lowResults.join(", ")+"]"}}),u("SuccessDice",{init:function(e){this.minimum=e},roll:function(e){var t,n,r=0,i=0,s=e.results,o=s.length,u=e.count,a=this.minimum;for(t=0;t<o;t++)n=s[t],n>=a?r++:t<u&&n===1&&i++;e.successes=r,e.failures=i,e.total=Math.max(r-i,0),e.fumbled=i>r},reset:function(e){delete e.successes,delete e.failures,delete e.fumbled},toString:function(e,t){t.suffix+=" successes"+(e.fumbled?"!":"")}}),u("HeroNormalDice",{roll:function(e){e.body=e.results.reduce(function(e,t){switch(t){case 1:break;case 6:e+=2;break;default:e+=1}return e},0),e.stun=e.total},reset:function(e){delete e.body,delete e.stun},toString:function(e,t){t.suffix+=" stun, "+e.body+" body"}}),u("WildDice",{init:function(e){this.amount=e||0},roll:function(e){var t=e.results.slice().reverse(),r=t.slice(0,this.amount||e.results.length),i=0;r.forEach(function(t){var r,s=e.sides;if(t===s){do r=n.rollDie(s),e.results.push(r);while(r===s)}else t===1&&i++}),e.total=e.results.reduce(n.reduceSum,0),e.complications=i,e.complication=i>0},reset:function(e){delete e.wildDice,delete e.complication,delete e.complications},toString:function(e,t){var n=e.complication,r=e.complications;t.suffix+=n?Array(r+1).join("!"):""}}),s.createFfgStarWarsBehavior=function(){function r(e){var t=this._columnNames,n=this._conversionTable;t.forEach(function(t,r){e[t]=e.results.reduce(function(e,t){return e+=n[t-1][r]},0)}),e.total=e[t[0]]}function i(e){this._columnNames.forEach(function(t){delete e[t]})}function s(e,t){var r=this._columnNames,i=this._conversionTable,s=r.reduce(function(e,t){return e[t]=0,e},{});t.label=this.name,t.results.forEach(function(e){r.forEach(function(t,n){var r=i[e-1][n];s[t]+=i[e-1][n]})}),t.results=t.results.map(function(e){return r.map(function(t,r){var s=i[e-1][r];return s?Array(s+1).join(n[t]):""}).join("")}),t.total=r.map(function(e){var t=s[e];return t?(t>1?t+"x":"")+n[e]:""}).join(", ")}var e={success:"failure",advantage:"threat",triumph:null},t={failure:"success",threat:"advantage",despair:null},n={success:"☼",advantage:"⇧",failure:"▼",threat:"⏣",triumph:"⇪",despair:"▽",lightside:"⚪",darkside:"⚫"};return function(e,t,n){return u(e,{name:e.replace(/^FfgStarWars(.*)Die$/,"$1"),_columnNames:t,_conversionTable:n,roll:r,reset:i,toString:s})}}(),s.createFfgStarWarsBehavior("FfgStarWarsBoostDie",["success","advantage"],[[0,0],[0,0],[0,2],[2,0],[0,1],[0,1]]),s.createFfgStarWarsBehavior("FfgStarWarsSetbackDie",["failure","threat"],[[0,0],[0,0],[1,0],[1,0],[0,1],[0,1]]),s.createFfgStarWarsBehavior("FfgStarWarsAbilityDie",["success","advantage"],[[0,0],[1,0],[1,0],[2,0],[0,1],[0,1],[1,1],[0,2]]),s.createFfgStarWarsBehavior("FfgStarWarsDifficultyDie",["failure","threat"],[[0,0],[1,0],[2,0],[0,1],[0,1],[0,1],[0,2],[1,1]]),s.createFfgStarWarsBehavior("FfgStarWarsProficiencyDie",["success","advantage","triumph"],[[0,0,0],[1,0,0],[1,0,0],[2,0,0],[2,0,0],[0,1,0],[1,1,0],[1,1,0],[1,1,0],[0,2,0],[0,2,0],[0,0,1]]),s.createFfgStarWarsBehavior("FfgStarWarsChallengeDie",["failure","threat","despair"],[[0,0,0],[1,0,0],[1,0,0],[2,0,0],[2,0,0],[0,1,0],[0,1,0],[1,1,0],[1,1,0],[0,2,0],[0,2,0],[0,0,1]]),s.createFfgStarWarsBehavior("FfgStarWarsForceDie",["lightside","darkside"],[[0,1],[0,1],[0,1],[0,1],[0,1],[0,1],[0,2],[1,0],[1,0],[2,0],[2,0],[2,0]]),n.merge(e,{Dice:s,hero:{normalDice:f(6,["HeroNormalDice"])},catalyst:{shadowrunDice:f(6,["WildDice",["SuccessDice",5]])},weg:{starWarsDice:function(e,t){var n=new s(e,6,[a("WildDice",1)]);return typeof t=="number"&&n.addBehavior(a("ResultModifier",t)),n}},ffg:{starWars:{boostDice:f(6,["FfgStarWarsBoostDie"]),setbackDice:f(6,["FfgStarWarsSetbackDie"]),abilityDice:f(8,["FfgStarWarsAbilityDie"]),difficultyDice:f(8,["FfgStarWarsDifficultyDie"]),proficiencyDice:f(12,["FfgStarWarsProficiencyDie"]),challengeDice:f(12,["FfgStarWarsChallengeDie"]),forceDice:f(12,["FfgStarWarsForceDie"])}}})}(typeof module!="undefined"?module.exports:this.diceJsLib={})